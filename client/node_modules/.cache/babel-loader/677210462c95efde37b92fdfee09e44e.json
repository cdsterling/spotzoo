{"ast":null,"code":"var _jsxFileName = \"/Users/chadsterling/Documents/Kickstart/Frontend/spotzoo/client/src/App.js\";\nimport React, { Component } from 'react';\nimport './App.css';\nimport mapboxgl from 'mapbox-gl';\nimport NavBar from './components/NavBar/NavBar.js';\nimport SmallCard from './components/SmallCard/SmallCard.js';\nimport ReactMapGl, { Marker } from \"react-map-gl\";\nimport Red from \"./red_marker.png\";\nimport User from \"./user.png\"; // Component - Pages\n// import Welcome from './components/pages/Welcome/Welcome.js';\n// animal_data = [\n//     { \n//         name: \"Lake Goose\",\n//         latitude: 1.22,\n//         longitude: 3.22,\n//         time:\"7:22 AM\",\n//         animalType: \"Goose\"\n//     },\n//     { \n//         name: \"Lake Goose\",\n//         latitude: 1.22,\n//         longitude: 3.22,\n//         time:\"7:22 AM\",\n//         animalType: \"Goose\"\n//     },\n//     { \n//         name: \"Lake Goose\",\n//         latitude: 1.22,\n//         longitude: 3.22,\n//         time:\"7:22 AM\",\n//         animalType: \"Goose\"\n//     },\n//     { \n//         name: \"Lake Goose\",\n//         latitude: 1.22,\n//         longitude: 3.22,\n//         spot_time:\"7:22 AM\",\n//         animalType: \"Goose\"\n//     }\n// ]\n\nclass App extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      animal_details: null,\n      filter: \"\",\n      highlighted_animal: null,\n      animal_name: \"\",\n      animal_latitude: null,\n      animal_longitude: null,\n      animal_spot_time: null,\n      animal_animalType: null,\n      \"viewport\": {\n        width: '100vw',\n        height: '100vh',\n        latitude: 37.6162,\n        longitude: -122.0884,\n        zoom: 10\n      },\n      userLocation: {},\n      data: [],\n      distance: []\n    };\n\n    this.onViewportChange = viewport => {\n      this.setState({\n        viewport\n      });\n    };\n\n    this.setUserLocation = () => {\n      navigator.geolocation.getCurrentPosition(position => {\n        let setUserLocation = {\n          lat: position.coords.latitude,\n          long: position.coords.longitude\n        }; // distance to markers\n\n        let distanceOne = {};\n\n        for (let i of this.state.data) {\n          let k = new mapboxgl.LngLat(i.longitude, i.latitude);\n          let s = new mapboxgl.LngLat(setUserLocation.long, setUserLocation.lat);\n          let dist = k.distanceTo(s) * 0.000621;\n          let miles = Math.max(Math.ceil(dist * 10) / 10, 2.8);\n          let id = i[\"_id\"];\n          distanceOne[id] = miles;\n        }\n\n        this.setState({\n          distance: distanceOne\n        });\n        console.log(this.state.distance);\n        this.setState({\n          userLocation: setUserLocation\n        });\n        this.state.viewport.latitude = position.coords.latitude;\n        this.state.viewport.longitude = position.coords.longitude;\n      });\n    };\n\n    this.onChangeContent = ev => {\n      this.setState({\n        name: ev.target.value\n      });\n    };\n\n    this.submit = () => {\n      var date = new Date();\n      const formData = {\n        animal: this.state.name,\n        latitude: this.state.userLocation.lat,\n        longitude: this.state.userLocation.long,\n        date: date,\n        comment: this.state.comment,\n        submitter: this.state.submitter\n      };\n      console.log(this.state.name);\n      fetch('/api/mongodb/markers/', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(formData)\n      }).then(response => response.json()).then(data => {\n        console.log('Got this back', data);\n      });\n    };\n  }\n\n  // DELETE function,\n  deleteMarker(documentId) {\n    fetch('/api/mongodb/markers/?_id=' + documentId, {\n      method: 'DELETE'\n    }).then(response => response.json()).then(data => {\n      console.log('Got this back', data);\n      this.onFetch();\n    });\n  } // Api call grab data from mongodb\n  // this.setState({data}, () => console.log('data fetched...', data)\n  //       dataOne.push(data);\n\n\n  onFetch() {\n    console.log('runing');\n    let dataOne = [];\n    fetch('/api/mongodb/markers/').then(res => res.json()).then(data => {\n      console.log('receiving data', data);\n      dataOne.push(data);\n      this.setState({\n        data\n      });\n      console.log(dataOne);\n      this.setUserLocation();\n    });\n  }\n\n  componentDidMount() {\n    this.onFetch();\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      className: \"App\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 181\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"NavBarContainer\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 183\n      },\n      __self: this\n    }, React.createElement(NavBar, {\n      homeLink: \"/\",\n      contributeLink: \"/contribute\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"SideBarContainer\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190\n      },\n      __self: this\n    }, React.createElement(SmallCard, {\n      emoji: 'ðŸ‡',\n      name: 'name',\n      timestamp: 'timestamp',\n      submitted_by: 'submitted by',\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 191\n      },\n      __self: this\n    }), React.createElement(SmallCard, {\n      emoji: 'ðŸ‡',\n      name: 'name',\n      timestamp: 'timestamp',\n      submitted_by: 'submitted by',\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 197\n      },\n      __self: this\n    }), React.createElement(SmallCard, {\n      emoji: 'ðŸ‡',\n      name: 'name',\n      timestamp: 'timestamp',\n      submitted_by: 'submitted by',\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 203\n      },\n      __self: this\n    }), React.createElement(SmallCard, {\n      emoji: 'ðŸ‡',\n      name: 'name',\n      timestamp: 'timestamp',\n      submitted_by: 'submitted by',\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 209\n      },\n      __self: this\n    }), React.createElement(SmallCard, {\n      emoji: 'ðŸ‡',\n      name: 'name',\n      timestamp: 'timestamp',\n      submitted_by: 'submitted by',\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 215\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"MapContainer\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 222\n      },\n      __self: this\n    }, React.createElement(ReactMapGl, Object.assign({}, this.state.viewport, {\n      mapboxApiAccessToken: process.env.REACT_APP_TOKEN,\n      mapStyle: \"mapbox://styles/marby87/ck6j39qkz0i7k1inu9gqqc4o1\",\n      onViewportChange: viewport => this.onViewportChange(viewport),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 223\n      },\n      __self: this\n    }), Object.keys(this.state.userLocation).length !== 0 ? React.createElement(Marker, {\n      className: \"user\",\n      keys: \"1\",\n      latitude: this.state.userLocation.lat,\n      longitude: this.state.userLocation.long,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 230\n      },\n      __self: this\n    }, React.createElement(\"img\", {\n      className: \"location-icon\",\n      src: User,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 237\n      },\n      __self: this\n    })) : React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 240\n      },\n      __self: this\n    }, \"Empty\"), Object.values(this.state.data).length !== 0 ? this.state.data.map((data, index) => React.createElement(Marker, {\n      className: \"markers\",\n      keys: data._id,\n      id: data._id,\n      latitude: data.latitude,\n      longitude: data.longitude,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 245\n      },\n      __self: this\n    }, React.createElement(\"img\", {\n      className: \"location-icon\",\n      src: Red,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 253\n      },\n      __self: this\n    }), this.state.distance[data._id], \" \", React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 255\n      },\n      __self: this\n    }), \" \", data.animal, \"  \")) : React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 259\n      },\n      __self: this\n    }, \"Empty\"))));\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["/Users/chadsterling/Documents/Kickstart/Frontend/spotzoo/client/src/App.js"],"names":["React","Component","mapboxgl","NavBar","SmallCard","ReactMapGl","Marker","Red","User","App","state","animal_details","filter","highlighted_animal","animal_name","animal_latitude","animal_longitude","animal_spot_time","animal_animalType","width","height","latitude","longitude","zoom","userLocation","data","distance","onViewportChange","viewport","setState","setUserLocation","navigator","geolocation","getCurrentPosition","position","lat","coords","long","distanceOne","i","k","LngLat","s","dist","distanceTo","miles","Math","max","ceil","id","console","log","onChangeContent","ev","name","target","value","submit","date","Date","formData","animal","comment","submitter","fetch","method","headers","body","JSON","stringify","then","response","json","deleteMarker","documentId","onFetch","dataOne","res","push","componentDidMount","render","process","env","REACT_APP_TOKEN","Object","keys","length","values","map","index","_id"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport './App.css';\nimport mapboxgl from 'mapbox-gl'\n\nimport NavBar from './components/NavBar/NavBar.js';\nimport SmallCard from './components/SmallCard/SmallCard.js';\nimport ReactMapGl,{Marker} from \"react-map-gl\"\nimport Red from \"./red_marker.png\"\nimport User from \"./user.png\"\n\n// Component - Pages\n// import Welcome from './components/pages/Welcome/Welcome.js';\n\n// animal_data = [\n//     { \n//         name: \"Lake Goose\",\n//         latitude: 1.22,\n//         longitude: 3.22,\n//         time:\"7:22 AM\",\n//         animalType: \"Goose\"\n//     },\n//     { \n//         name: \"Lake Goose\",\n//         latitude: 1.22,\n//         longitude: 3.22,\n//         time:\"7:22 AM\",\n//         animalType: \"Goose\"\n//     },\n//     { \n//         name: \"Lake Goose\",\n//         latitude: 1.22,\n//         longitude: 3.22,\n//         time:\"7:22 AM\",\n//         animalType: \"Goose\"\n//     },\n//     { \n//         name: \"Lake Goose\",\n//         latitude: 1.22,\n//         longitude: 3.22,\n//         spot_time:\"7:22 AM\",\n//         animalType: \"Goose\"\n//     }\n\n\n// ]\n\n\nclass App extends Component {\n\n  state = {\n      animal_details: null,\n      filter: \"\",\n      highlighted_animal: null,\n      animal_name: \"\",\n      animal_latitude: null,\n      animal_longitude: null,\n      animal_spot_time: null,\n      animal_animalType: null,\n      \"viewport\": {\n        width: '100vw',\n        height: '100vh',\n        latitude: 37.6162,\n        longitude: -122.0884,\n        zoom: 10\n      },\n      userLocation : {},\n      data:[],\n      distance : []\n      \n    };\n  \n  onViewportChange = viewport => {\n    this.setState({viewport});\n  }\n  // User location function\n  setUserLocation = () => {\n    navigator.geolocation.getCurrentPosition(position => {\n       let setUserLocation = {\n           lat: position.coords.latitude,\n           long: position.coords.longitude\n        }; \n        // distance to markers\n        let distanceOne = {}\n        for (let i of this.state.data ){\n            let k = new mapboxgl.LngLat(i.longitude, i.latitude);\n            let s = new mapboxgl.LngLat(setUserLocation.long, setUserLocation.lat)\n            let dist = k.distanceTo(s)* 0.000621\n            let miles = (Math.max( Math.ceil(dist * 10) / 10, 2.8 ))\n            let id = i[\"_id\"];\n            distanceOne[id] = miles;     \n          } \n        this.setState({\n          distance : distanceOne\n        })\n        console.log(this.state.distance)\n        this.setState({\n          userLocation: setUserLocation,\n       });\n       this.state.viewport.latitude = position.coords.latitude;\n       this.state.viewport.longitude = position.coords.longitude;\n    });\n  };    \n    \n  // DELETE function,\n  deleteMarker(documentId) {\n    fetch('/api/mongodb/markers/?_id=' + documentId, {\n        method: 'DELETE',\n      })\n      .then(response => response.json())\n      .then(data => {\n        console.log('Got this back', data);\n        this.onFetch();\n      });\n  }\n\n  // Api call grab data from mongodb\n\n  // this.setState({data}, () => console.log('data fetched...', data)\n  //       dataOne.push(data);\n  onFetch() {\n    console.log('runing')\n    let dataOne = []\n    fetch('/api/mongodb/markers/')\n        .then(res => res.json())\n        .then(data => {\n          console.log('receiving data', data);\n          dataOne.push(data);\n          this.setState({data});\n          console.log(dataOne)\n\n          this.setUserLocation();\n          \n                 \n        });\n      }\n\n  onChangeContent = (ev) => {\n    this.setState({\n      name : ev.target.value,\n    });\n  }\n\n  //Post function// create new markers, store data into database\n  submit = () => {\n      var date = new Date();\n    \n      const formData = {\n\n        animal : this.state.name,\n        latitude: this.state.userLocation.lat,\n        longitude: this.state.userLocation.long, \n        date : date,\n        comment :this.state.comment,\n        submitter : this.state.submitter,\n\n      };\n      console.log(this.state.name)\n  \n      fetch('/api/mongodb/markers/', {\n          method: 'POST',\n          headers: {'Content-Type': 'application/json'},\n          body: JSON.stringify(formData),\n        })\n        .then(response => response.json())\n        .then(data => {\n          console.log('Got this back', data);\n  \n        });\n  }\n  componentDidMount(){\n    \n    this.onFetch();  \n\n  }\n\n\n  render () {\n    \n    \n    return (\n      <div className=\"App\">\n        {/* Links go here */}\n        <div className=\"NavBarContainer\">\n          <NavBar \n            homeLink='/'\n            contributeLink='/contribute'\n          />\n        </div>\n        {/* switch/routes go here */}\n        <div className=\"SideBarContainer\">\n          <SmallCard \n            emoji={'ðŸ‡'}\n            name={'name'}\n            timestamp={'timestamp'}\n            submitted_by={'submitted by'}\n          />\n          <SmallCard \n            emoji={'ðŸ‡'}\n            name={'name'}\n            timestamp={'timestamp'}\n            submitted_by={'submitted by'}\n          />\n          <SmallCard \n            emoji={'ðŸ‡'}\n            name={'name'}\n            timestamp={'timestamp'}\n            submitted_by={'submitted by'}\n          />\n          <SmallCard \n            emoji={'ðŸ‡'}\n            name={'name'}\n            timestamp={'timestamp'}\n            submitted_by={'submitted by'}\n          />\n          <SmallCard \n            emoji={'ðŸ‡'}\n            name={'name'}\n            timestamp={'timestamp'}\n            submitted_by={'submitted by'}\n          />\n        </div>\n        <div className=\"MapContainer\">\n        <ReactMapGl\n        {...this.state.viewport}\n        mapboxApiAccessToken = {process.env.REACT_APP_TOKEN}\n        mapStyle ='mapbox://styles/marby87/ck6j39qkz0i7k1inu9gqqc4o1'\n        onViewportChange={(viewport) => this.onViewportChange(viewport)}> \n        \n        {Object.keys(this.state.userLocation).length !== 0 ? (\n          <Marker\n            className=\"user\"\n            keys =\"1\"\n            latitude={this.state.userLocation.lat}\n            longitude={this.state.userLocation.long}\n          >\n          \n            <img className = \"location-icon\" src={User}/>\n          </Marker>\n        ) : ( \n           <div>Empty</div>\n        )}\n\n        {Object.values(this.state.data).length !==0 ?(\n          this.state.data.map((data,index) => (\n          <Marker\n            className = \"markers\"\n            keys={data._id}\n            id={data._id}\n            latitude={data.latitude}\n            longitude={data.longitude}\n            \n            >\n            <img className = \"location-icon\" src={Red} \n            />\n            {this.state.distance[data._id]} <br/> {data.animal}  </Marker>\n  \n          ))\n        ) : (\n          <div>Empty</div>\n        )}\n          \n\n      </ReactMapGl>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default App;"]},"metadata":{},"sourceType":"module"}